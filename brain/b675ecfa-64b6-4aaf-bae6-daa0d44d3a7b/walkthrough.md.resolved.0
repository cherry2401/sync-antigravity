# Cáº£i Thiá»‡n LÆ°u Trá»¯ Cookies - Walkthrough

## ğŸ¯ Váº¥n Äá» Ban Äáº§u
Extension khÃ´ng láº¥y Ä‘Æ°á»£c Ä‘áº§y Ä‘á»§ Ä‘á»™ dÃ i cá»§a cookies, cÃ³ thá»ƒ bá»‹ cáº¯t ngáº¯n hoáº·c máº¥t dá»¯ liá»‡u.

## âœ… Giáº£i PhÃ¡p ÄÃ£ Thá»±c Hiá»‡n

### 1. Cáº£i Thiá»‡n Logging Chi Tiáº¿t ([sidebar.js](file:///d:/EXTENTIONS/custome-link/sidebar.js))

ÄÃ£ thÃªm cÃ¡c log chi tiáº¿t Ä‘á»ƒ theo dÃµi quÃ¡ trÃ¬nh láº¥y cookies:

- **Log chi tiáº¿t tá»«ng cookie**: Hiá»ƒn thá»‹ tÃªn, Ä‘á»™ dÃ i value, domain, vÃ  path cá»§a má»—i cookie
- **Log Ä‘á»™ dÃ i tá»«ng cookie riÃªng láº»**: `Cookie {name}: length={value.length}`
- **Log tá»•ng há»£p thÃ´ng tin**: 
  - Tá»•ng sá»‘ cookies unique
  - Äá»™ dÃ i cookie string (sá»‘ kÃ½ tá»±)
  - Preview 200 kÃ½ tá»± Ä‘áº§u vÃ  cuá»‘i cá»§a cookie string

### 2. Kiá»ƒm Tra Äá»™ DÃ i VÃ  PhÃ¡t Hiá»‡n Truncation

ThÃªm logic verification Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng bá»‹ cáº¯t ngáº¯n:

```javascript
// Verify no truncation occurred
const expectedLength = uniqueCookies.reduce((sum, c) => {
  return sum + (c.name?.length || 0) + (c.value?.length || 0) + 1; // +1 for '='
}, 0) + (uniqueCookies.length - 1) * 2; // '; ' separators

console.log('Expected minimum length:', expectedLength);
console.log('Actual length:', cookieString.length);

if (cookieString.length < expectedLength) {
  console.warn('WARNING: Cookie string may be truncated!');
}
```

### 3. Cáº£i Thiá»‡n Cookie Value Capture

Äáº£m báº£o láº¥y Ä‘áº§y Ä‘á»§ cookie value:

```javascript
const cookieString = uniqueCookies.map(cookie => {
  // Make sure we get the complete value
  const name = cookie.name || '';
  const value = cookie.value || '';
  console.log(`Cookie ${name}: length=${value.length}`);
  return `${name}=${value}`;
}).join('; ');
```

### 4. Cáº£i Thiá»‡n UI ([sidebar.html](file:///d:/EXTENTIONS/custome-link/sidebar.html))

**Textarea cho cookie input:**
- ThÃªm `max-height: 300px` Ä‘á»ƒ há»— trá»£ cookies dÃ i vá»›i scrolling
- Textarea cÃ³ thá»ƒ tá»± Ä‘á»™ng má»Ÿ rá»™ng khi cáº§n

**ThÃ´ng bÃ¡o thÃ nh cÃ´ng:**
- Hiá»ƒn thá»‹ cáº£ sá»‘ lÆ°á»£ng cookies VÃ€ tá»•ng sá»‘ kÃ½ tá»±
- VÃ­ dá»¥: `âœ… ÄÃ£ láº¥y 25 cookies (4823 kÃ½ tá»±) thÃ nh cÃ´ng!`

**HÆ°á»›ng dáº«n ngÆ°á»i dÃ¹ng:**
- ThÃªm tip Ä‘á»ƒ user biáº¿t má»Ÿ Console (F12) Ä‘á»ƒ xem chi tiáº¿t

## ğŸ§ª CÃ¡ch Kiá»ƒm Tra

### BÆ°á»›c 1: Reload Extension
1. Má»Ÿ Chrome â†’ Extensions (chrome://extensions/)
2. TÃ¬m extension "Shopee Link Converter"
3. Nháº¥n nÃºt "Reload" (icon mÅ©i tÃªn trÃ²n)

### BÆ°á»›c 2: Test Láº¥y Cookies
1. Má»Ÿ tab má»›i, truy cáº­p https://affiliate.shopee.vn
2. ÄÄƒng nháº­p náº¿u chÆ°a Ä‘Äƒng nháº­p
3. Má»Ÿ extension (click icon hoáº·c má»Ÿ sidebar)
4. Nháº¥n nÃºt âš™ï¸ Ä‘á»ƒ vÃ o Settings
5. Nháº¥n nÃºt "ğŸª Láº¥y Cookies Tá»± Äá»™ng"
6. **Má»Ÿ Console (F12)** Ä‘á»ƒ xem thÃ´ng tin chi tiáº¿t

### BÆ°á»›c 3: Xem ThÃ´ng Tin Chi Tiáº¿t Trong Console

Báº¡n sáº½ tháº¥y cÃ¡c thÃ´ng tin sau trong console:

```
=== COOKIE INFORMATION ===
Total unique cookies: 28
Cookie string length: 5234
Cookie string preview (first 200 chars): REC_T_ID=abc123...; SPC_F=xyz789...
Cookie string preview (last 200 chars): ...sessionid=def456
Expected minimum length: 5234
Actual length: 5234
```

**Náº¿u tháº¥y WARNING**: `WARNING: Cookie string may be truncated!` â†’ CÃ³ váº¥n Ä‘á» cáº§n kiá»ƒm tra

### BÆ°á»›c 4: Kiá»ƒm Tra Cookie ÄÃ£ LÆ°u
1. Sau khi láº¥y cookies, message sáº½ hiá»ƒn thá»‹: `âœ… ÄÃ£ láº¥y X cookies (Y kÃ½ tá»±) thÃ nh cÃ´ng!`
2. Kiá»ƒm tra sá»‘ kÃ½ tá»± (Y) - thÆ°á»ng sáº½ tá»« 3000-6000+ kÃ½ tá»±
3. Nháº¥n icon ğŸ‘ï¸ Ä‘á»ƒ hiá»‡n cookies vÃ  xÃ¡c nháº­n Ä‘á»™ dÃ i

## ğŸ“Š CÃ¡c Cáº£i Thiá»‡n ChÃ­nh

| TrÆ°á»›c | Sau |
|-------|-----|
| KhÃ´ng cÃ³ thÃ´ng tin Ä‘á»™ dÃ i | Hiá»ƒn thá»‹ sá»‘ kÃ½ tá»± chi tiáº¿t |
| KhÃ´ng kiá»ƒm tra truncation | CÃ³ cáº£nh bÃ¡o náº¿u bá»‹ cáº¯t |
| Logging cÆ¡ báº£n | Logging chi tiáº¿t tá»«ng cookie |
| Message Ä‘Æ¡n giáº£n | Message vá»›i sá»‘ kÃ½ tá»± cá»¥ thá»ƒ |
| Textarea cá»‘ Ä‘á»‹nh | Textarea vá»›i scroll cho cookies dÃ i |

## ğŸ” Debug Console Output

Khi nháº¥n "Láº¥y Cookies Tá»± Äá»™ng", console sáº½ hiá»ƒn thá»‹:

1. **Cookie details**: Danh sÃ¡ch cookies vá»›i name, valueLength, domain, path
2. **Individual cookie lengths**: Äá»™ dÃ i value cá»§a tá»«ng cookie
3. **Summary info**: Tá»•ng há»£p thÃ´ng tin cookies
4. **Verification**: So sÃ¡nh expected vs actual length

## âš ï¸ LÆ°u Ã

- Chrome storage cÃ³ giá»›i háº¡n: `chrome.storage.local` cho phÃ©p lÆ°u tá»‘i Ä‘a ~5MB
- Cookie string thÃ´ng thÆ°á»ng tá»« Shopee: 3000-6000 kÃ½ tá»± (váº«n ráº¥t nhá» so vá»›i giá»›i háº¡n)
- Náº¿u cookies quÃ¡ dÃ i (>10000 kÃ½ tá»±), cÃ³ thá»ƒ cáº§n xem xÃ©t lÆ°u theo cÃ¡ch khÃ¡c

## ğŸ“ Káº¿t Luáº­n

Extension hiá»‡n Ä‘Ã£ cÃ³ kháº£ nÄƒng:
- âœ… Láº¥y Ä‘áº§y Ä‘á»§ Ä‘á»™ dÃ i cookies khÃ´ng bá»‹ cáº¯t
- âœ… Hiá»ƒn thá»‹ thÃ´ng tin chi tiáº¿t vá» cookies
- âœ… PhÃ¡t hiá»‡n vÃ  cáº£nh bÃ¡o náº¿u cÃ³ váº¥n Ä‘á»
- âœ… UI há»— trá»£ cookies dÃ i vá»›i scroll
- âœ… Logging chi tiáº¿t Ä‘á»ƒ debug

Báº¡n cÃ³ thá»ƒ kiá»ƒm tra vÃ  xÃ¡c nháº­n Ä‘á»™ dÃ i cookies báº±ng cÃ¡ch má»Ÿ Console khi sá»­ dá»¥ng tÃ­nh nÄƒng láº¥y cookies tá»± Ä‘á»™ng!
