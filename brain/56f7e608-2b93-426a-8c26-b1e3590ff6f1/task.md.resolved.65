# Shop Features Tasks

## Product Listing Page ‚úÖ
- [x] [getFilteredProducts(params)](file:///i:/Website/MyphamHaKi/app-src/src/lib/actions/products.ts#162-263) server action
- [x] `useProductFilter` hook with debounce
- [x] `ProductFilters` sidebar component
- [x] [ProductGrid](file:///i:/Website/MyphamHaKi/app-src/src/components/shop/ProductGrid.tsx#33-215) with pagination
- [x] Mobile filter drawer
- [x] URL-based filtering

## Live Search ‚úÖ
- [x] [searchProducts(keyword)](file:///i:/Website/MyphamHaKi/app-src/src/lib/actions/products.ts#85-133) server action
- [x] Vietnamese normalization search
- [x] 300ms debounce
- [x] 5 result limit
- [x] Sale price display (red + strikethrough)
- [x] Keyboard navigation (‚Üë‚Üì Enter)
- [x] Recent searches localStorage

## User Authentication üîí
- [x] Install dependencies (`next-auth`, `bcryptjs`) & Update Schema
- [x] Configure NextAuth ([auth.ts](file:///i:/Website/MyphamHaKi/app-src/src/auth.ts), [auth.config.ts](file:///i:/Website/MyphamHaKi/app-src/src/auth.config.ts))
- [x] Implement Server Actions ([register](file:///i:/Website/MyphamHaKi/app-src/src/actions/auth-actions.ts#21-69), [login](file:///i:/Website/MyphamHaKi/app-src/src/actions/auth-actions.ts#70-106))
- [x] Update Login/Register UI
- [x] Link Order to User

## Wishlist Feature ‚ù§Ô∏è
- [ ] Database Schema ([Wishlist](file:///i:/Website/MyphamHaKi/app-src/src/app/tai-khoan/yeu-thich/page.tsx#11-60) model)
- [ ] Server Actions ([toggleWishlist](file:///i:/Website/MyphamHaKi/app-src/src/actions/wishlist.ts#11-56), [getWishlist](file:///i:/Website/MyphamHaKi/app-src/src/actions/wishlist.ts#61-81))
- [ ] [WishlistButton](file:///i:/Website/MyphamHaKi/app-src/src/components/product/WishlistButton.tsx#16-81) component (Optimistic UI)
- [ ] Wishlist Page (`/tai-khoan/yeu-thich`)
- [ ] Wishlist Page (`/tai-khoan/yeu-thich`)
- [ ] Integrate with [ProductCard](file:///i:/Website/MyphamHaKi/app-src/src/components/product/ProductCard.tsx#88-324)

## Address Book Feature üìç
- [x] Database Schema ([Address](file:///i:/Website/MyphamHaKi/app-src/src/components/address/AddressBookClient.tsx#9-19) model)
- [x] Server Actions (`CRUD Address`)
- [x] [AddressForm](file:///i:/Website/MyphamHaKi/app-src/src/components/address/AddressForm.tsx#49-217) component (Reuse location selectors)
- [x] Address Book Page (`/tai-khoan/dia-chi`)

## Checkout Address Integration üõí
- [x] Fetch saved addresses in Checkout page
- [x] Display address selection in CheckoutForm
- [x] Auto-fill form with selected address
- [x] Default selection for isDefault address
- [x] Shopee-style Address UI (Compact Card + Modal)

## Payment Flow Integration üí∏
- [x] VietQR Bank Config ([src/lib/bank-config.ts](file:///i:/Website/MyphamHaKi/app-src/src/lib/bank-config.ts))
- [x] Payment Page with QR (`/thanh-toan/payment/[id]`)
- [x] Redirect Checkout -> Payment Page
- [x] Clean Success Page (Pure Thank You)

## Create Product Feature (Admin) üì¶
- [x] Update Schema ([Product](file:///i:/Website/MyphamHaKi/app-src/src/components/product/ProductCard.tsx#15-30), [Wishlist](file:///i:/Website/MyphamHaKi/app-src/src/app/tai-khoan/yeu-thich/page.tsx#11-60) relations)
- [x] Cloudinary Config ([.env.local](file:///i:/Website/MyphamHaKi/app-src/.env.local))
- [x] Server Action ([createProduct](file:///i:/Website/MyphamHaKi/app-src/src/actions/product.ts#8-77))
- [x] Client Form Integration ([ProductForm.tsx](file:///i:/Website/MyphamHaKi/app-src/src/components/admin/ProductForm.tsx) + Cloudinary Upload)
- [x] Fix Prisma Types & Relation Errors

## Bug Fixes & Refinement üêõ
- [x] Fix PrismaClient types
- [x] Fix TypeScript errors in Product pages (rating/toast)
- [x] Fix TypeScript errors in Product pages (rating/toast)
- [x] Fix Login Redirect Issue (Server Component Refactor)
- [x] Secure Admin Routes (Middleware Protection)

## Category & Brand CRUD Sync üè∑Ô∏è
- [x] Add [Category](file:///i:/Website/MyphamHaKi/app-src/src/app/san-pham/ProductListingClient.tsx#13-19) and [Brand](file:///i:/Website/MyphamHaKi/app-src/src/app/san-pham/ProductListingClient.tsx#20-25) models to schema
- [x] Add `/san-pham` revalidation to [lib/actions/categories.ts](file:///i:/Website/MyphamHaKi/app-src/src/lib/actions/categories.ts)
- [x] Add `/san-pham` revalidation to [lib/actions/brands.ts](file:///i:/Website/MyphamHaKi/app-src/src/lib/actions/brands.ts)
- [x] Add `router.refresh()` to admin danh-muc page
- [x] Add `router.refresh()` to admin thuong-hieu page
- [x] Sync ProductForm dropdowns with dynamic server data
